## 마이크로서비스는 목표가 아니다
`현재 아키텍처에서 최종 목표를 달성하는 더 쉬운 방법을 찾을 수 없는 경우`에만 마이크로서비스를 고려해야한다
달성할 목표가 무엇인지 정확히하고 목표를 달성할 수 있는 더 쉬운 방법을 먼저 고려해야한다
<br/><br/>

## 점진적 마이그레이션
모놀리식 시스템을 분해하는 것이 옳다고 판단했다면, 시스템을 조금씩 나눠서 분해하는 것이 좋다
1 ~ 2개의 기능 영역을 선택하고 마이크로서비스로 구현하여 배포한 뒤, 목표에 가까워졌는지 확인해보자
<br/><br/>

## 모놀리스가 적인 경우는 드물다
모놀리스가 없는 것에 집중하는 것이 아닌 `아키텍처의 변경이 가져올 혜택에 집중해라`
모놀리스의 완전한 제거는 매우 어려운 요구사항이 될 수 있다
점진적 마이그레이션 과정에서 개선점을 도출할 수 있고, 언제 마이그레이션을 멈춰야할 지도 알 수 있다
<br/><br/>
## 조급한 분해의 위험성
도메인을 제대로 이해하지 못한 상태에서 마이크로서비스를 생성할 경우 `개발 당시의 의도와 실제 사용시의 서비스 경계에 대한 경험의 차이`가 생겨 추후 대대적인 변경이 필요할 수 있다
<br/><br/>
## 분해 우선순위
분해 우선순위는 분해 작업의 용이성 <-> 분해시 장점 의 균형에서 결정된다
초기에는 분해 작업의 용이성을 우선순위에 두고 실행하는 것이 좋다
<br/><br/>
## 계층별 분해

### 코드 우선
기능과 관련된 코드를 마이크로서비스로 추출하고 데이터는 모놀리식 DB에 남겨두는 방식
데이터를 추출하는 것보다 더 쉬운 경우가 많다
이는 단기적인 이익을 전달하기 쉽지만 데이터를 추출하는 것을 추후로 미뤄둔 것이나 마찬가지이다
<br/><br/>
### 데이터 우선
데이터를 깔끔하게 분리 가능한지 불확실한 상황에서 이를 먼저 확인하는데 도움이 된다
그러나 데이터를 꺼내는 과정에서 무결성 손실같은 문제는 미리 처리해둬야한다
<br/><br/>
## 유용한 분해 패턴

### 교살자 무화과 패턴
로드밸런서 레이어를 두어, 기존 모놀리스에 대한 호출이 새로 만든 마이크로서비스로 전달되도록 한다
<br/><br/>
### 병렬 실행
기존 모놀리스와 새로 만든 마이크로서비스를 동시에 호출하여 같은 결과를 리턴하는지 확인한다
<br/><br/>
### 기능 토글
기능을 켜고 끌 수 있도록 하는 매커니즘
<br/><br/>
## 데이터 분해 과정에서의 문제점

### 성능
마이크로서비스로 데이터를 분리한다면, DB 테이블간에 가능했던 조인을 통신단에서 처리해야하고 이로 인한 성능저하가 생길 수 있다
대량으로 데이터를 가져오거나, 캐싱하여 지연 시간 문제를 완화할 수 있다
<br/><br/>
### 데이터 무결성
데이터가 분리되면 DB를 통한 엔티티간 관계 무결성을 유지할 수 없게된다
무결성을 위한 우회 방법으로는 coping pattern이 있다.
실제 레코드를 삭제하지않고 삭제된 것으로 표현하거나 판매시 상품명을 복사하는 방식이다
<br/><br/>
### 트랜잭션
데이터가 분리되면 ACID 트랜잭션 안정성을 잃게된다
우회 방법으로는 saga pattern이 있다

